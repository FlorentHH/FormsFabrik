"Screen5 As screen.'tabletLayout_PeoplePicker_ver3.0'":
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    RectQuickActionBar1 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Height: =64
        Width: =Parent.Width
        ZIndex: =1

    LblAppName1 As label:
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        Height: =64
        Size: =18
        Text: ="People"
        Width: =Parent.Width - Self.X * 2
        Wrap: =false
        X: =32
        ZIndex: =2

    TextSearchBox1 As text:
        Default: =""
        HintText: ="Search"
        PaddingLeft: =70
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        Y: =RectQuickActionBar1.Height
        ZIndex: =3

    SearchIcon1 As icon.Search:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =Self.Width
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Search
        PaddingBottom: =8
        PaddingLeft: =8
        PaddingRight: =8
        PaddingTop: =8
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Tooltip: ="Search"
        Width: =TextSearchBox1.Height
        X: =24
        Y: =TextSearchBox1.Y
        ZIndex: =4

    RectSeparator1 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        Fill: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        Height: =1
        Width: =Parent.Width
        Y: =TextSearchBox1.Y + TextSearchBox1.Height
        ZIndex: =5

    PeopleAddedGallery1 As gallery.SelectedUsersTabletGallery:
        AccessibleLabel: ="User selected people"
        BorderColor: =RGBA(166, 166, 166, 1)
        Height: =Parent.Height - Self.Y
        Items: =MyPeople
        Layout: =Layout.Vertical
        TemplateSize: =47
        Width: =Parent.Width
        WrapCount: =4
        Y: =TextSearchBox1.Y + TextSearchBox1.Height + 8
        ZIndex: =6

        Rectangle1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0, 120, 212, 1)
            FocusedBorderThickness: =4
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(0, 120, 212, 1)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(0, 120, 212, 1)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title1 As label:
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =PeopleAddedGallery1.TemplateHeight
            OnSelect: =Set(_selectedUser, ThisItem)
            PaddingLeft: =10
            Size: =13
            TabIndex: =If(UserBrowseGallery1.Visible, -1, 0)
            Text: =ThisItem.DisplayName
            Width: =PeopleAddedGallery1.TemplateWidth - iconRemove1.Width + 10
            Wrap: =false
            ZIndex: =2

        iconRemove1 As icon.Cancel:
            AccessibleLabel: =iconRemove1.Tooltip
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =Title1.Color
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Height: =PeopleAddedGallery1.TemplateHeight
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: =Remove(MyPeople, LookUp(MyPeople, UserPrincipalName = ThisItem.UserPrincipalName))
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            TabIndex: =If(UserBrowseGallery1.Visible, -1, 0)
            Tooltip: ="Select to remove user from collection"
            Width: =Self.Height
            X: =PeopleAddedGallery1.TemplateWidth - Self.Width
            ZIndex: =3

    iconEmptyState1 As icon.Person:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: =DisplayMode.View
        FocusedBorderThickness: =4
        Height: =55
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Person
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =IsEmpty(MyPeople)
        Width: =55
        X: =Parent.Width / 2 - Self.Width/2
        Y: =Parent.Height / 2 - Self.Height / 2 - 100
        ZIndex: =7

    LblEmptyState1 As label:
        Align: =Align.Center
        Color: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        Height: =50
        Size: =19
        Text: ="Find users in your organization"
        Visible: =IsEmpty(MyPeople)
        Width: =535
        Wrap: =false
        X: =Parent.Width / 2 - Self.Width/2
        Y: =iconEmptyState1.Y + iconEmptyState1.Height + 20
        ZIndex: =8

    UserBrowseGallery1 As gallery.PeoplePickerTabletGallery:
        AccessibleLabel: ="User look up search results"
        BorderColor: =RGBA(166, 166, 166, 1)
        Fill: =Parent.Fill
        Height: =Parent.Height - Self.Y
        Items: |-
            =If(!IsBlank(Trim(TextSearchBox1.Text)), Office365Users.SearchUser({searchTerm: Trim(TextSearchBox1.Text), top: 15}))
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: =87
        Visible: =!IsBlank(Trim(TextSearchBox1.Text))
        Width: =Parent.Width
        Y: =TextSearchBox1.Y + TextSearchBox1.Height
        ZIndex: =9

        Rectangle2 As rectangle:
            BorderColor: =Title3.Color
            BorderThickness: =If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 2, 0)
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0,0,0,0)
            Height: =Parent.TemplateHeight - 2*Self.Y
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title3)
            PressedFill: =RGBA(0, 120, 212, 1)
            Width: =Parent.TemplateWidth - 2*Self.X
            X: =1
            Y: =1
            ZIndex: =1

        iconUser1 As icon.Person:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            Fill: =RectQuickActionBar1.Fill
            Height: =ProfileImage1.Height
            Icon: =Icon.Person
            OnSelect: =Select(Title3)
            PaddingBottom: =12
            PaddingLeft: =12
            PaddingRight: =12
            PaddingTop: =12
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =ProfileImage1.Width
            X: =ProfileImage1.X
            Y: =ProfileImage1.Y
            ZIndex: =2

        ProfileImage1 As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Height: =Self.Width
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =If(!IsBlank(ThisItem.Id), Office365Users.UserPhotoV2(ThisItem.Id))
            OnSelect: =Select(Title3)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =UserBrowseGallery1.TemplateHeight - 30
            X: =37
            Y: =(UserBrowseGallery1.TemplateHeight / 2) - (Self.Height/2)
            ZIndex: =3

        Title3 As label:
            BorderColor: =Self.Color
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =Self.Size * 1.8
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                Concurrent(
                Set(_selectedUser, ThisItem),
                Reset(TextSearchBox1),
                If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName), Collect(MyPeople, ThisItem)))
            Size: =12
            TabIndex: =0
            Text: =ThisItem.DisplayName
            Width: =UserBrowseGallery1.TemplateWidth - 232
            Wrap: =false
            X: =ProfileImage1.X + ProfileImage1.Width + 16
            Y: =16
            ZIndex: =4

        Subtitle1 As label:
            Color: =RGBA(51, 51, 51, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =Self.Size * 1.8
            OnSelect: =Select(Title3)
            Size: =12
            Text: =ThisItem.UserPrincipalName
            Width: =Title3.Width
            Wrap: =false
            X: =Title3.X
            Y: =UserBrowseGallery1.TemplateHeight - Self.Height - 20
            ZIndex: =5

        Separator1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =6

